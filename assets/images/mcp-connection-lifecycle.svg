<?xml version="1.0" encoding="UTF-8"?>

<svg aria-roledescription="sequence" role="graphics-document document" viewBox="-70 -30 938 1176" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" id="r2r">
  <!-- White background rectangle with consistent padding -->
  <rect x="-70" y="-30" width="938" height="1176" fill="white"/>
  <style>
    #r2r {
      font-family: sans-serif;
      font-size: 16px;
    }
    #r2r .actor {
      stroke: #666;
      fill: #eaeaea;
    }
    #r2r .actor-line {
      stroke: #999;
      stroke-width: 0.5px;
    }
    #r2r .actor-box {
      text-anchor: middle;
      font-size: 16px;
      font-weight: 400;
      fill: #000;
    }
    #r2r .messageLine0 {
      stroke-width: 1.5;
      stroke: #222;
      fill: none;
    }
    #r2r .messageLine1 {
      stroke-width: 1.5;
      stroke-dasharray: 3, 3;
      stroke: #222;
      fill: none;
    }
    #r2r .messageText {
      font-family: sans-serif;
      font-size: 16px;
      font-weight: 400;
      text-anchor: middle;
      fill: #000;
    }
    #r2r .loopLine {
      stroke: #666;
      stroke-width: 1px;
    }
    #r2r .note {
      stroke: #666;
      fill: #EDF2AE;
    }
    #r2r .noteText {
      font-family: sans-serif;
      font-size: 16px;
      font-weight: 400;
      text-anchor: middle;
      fill: #000;
    }
    #r2r .activation0 {
      fill: #EDF2AE;
      stroke: #666;
    }
    #r2r .labelBox {
      fill: #eaeaea;
      stroke: #666;
    }
    #r2r .labelText {
      font-family: sans-serif;
      font-size: 16px;
      font-weight: 400;
      text-anchor: middle;
      fill: #000;
    }
    #r2r .loopText {
      font-family: sans-serif;
      font-size: 16px;
      font-weight: 400;
      text-anchor: middle;
      fill: #000;
    }
    #r2r .arrowhead {
      fill: #222;
    }
    #r2r .filled-head {
      fill: #222;
    }
  </style>
  
  <defs>
    <marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead">
      <path d="M -1 0 L 10 5 L 0 10 z"></path>
    </marker>
    <marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead">
      <path style="stroke-dasharray: 0, 0;" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path>
    </marker>
    <marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head">
      <path d="M 18,7 L9,13 L14,7 L9,1 Z"></path>
    </marker>
  </defs>
  
  <!-- Actor boxes (top) -->
  <g>
    <rect class="actor" ry="3" rx="3" height="65" width="150" y="0" x="0"></rect>
    <text class="actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75">
      <tspan dy="0" x="75">Host</tspan>
    </text>
  </g>
  <g>
    <rect class="actor" ry="3" rx="3" height="65" width="150" y="0" x="303"></rect>
    <text class="actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="378">
      <tspan dy="0" x="378">Client</tspan>
    </text>
  </g>
  <g>
    <rect class="actor" ry="3" rx="3" height="65" width="150" y="0" x="648"></rect>
    <text class="actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="723">
      <tspan dy="0" x="723">Server</tspan>
    </text>
  </g>
  
  <!-- Actor boxes (bottom) -->
  <g>
    <rect class="actor" ry="3" rx="3" height="65" width="150" y="1050" x="0"></rect>
    <text class="actor-box" alignment-baseline="central" dominant-baseline="central" y="1082.5" x="75">
      <tspan dy="0" x="75">Host</tspan>
    </text>
  </g>
  <g>
    <rect class="actor" ry="3" rx="3" height="65" width="150" y="1050" x="303"></rect>
    <text class="actor-box" alignment-baseline="central" dominant-baseline="central" y="1082.5" x="378">
      <tspan dy="0" x="378">Client</tspan>
    </text>
  </g>
  <g>
    <rect class="actor" ry="3" rx="3" height="65" width="150" y="1050" x="648"></rect>
    <text class="actor-box" alignment-baseline="central" dominant-baseline="central" y="1082.5" x="723">
      <tspan dy="0" x="723">Server</tspan>
    </text>
  </g>
  
  <!-- Actor lines -->
  <g>
    <line class="actor-line" y2="1050" x2="75" y1="65" x1="75"></line>
    <line class="actor-line" y2="1050" x2="378" y1="65" x1="378"></line>
    <line class="actor-line" y2="1050" x2="723" y1="65" x1="723"></line>
  </g>
  
  <!-- Activation boxes -->
  <g>
    <rect class="activation0" height="915" width="10" y="115" x="373"></rect>
    <rect class="activation0" height="863" width="10" y="167" x="718"></rect>
  </g>
  
  <!-- Note -->
  <g>
    <rect class="note" height="40" width="698" y="225" x="50"></rect>
    <text class="noteText" alignment-baseline="middle" dominant-baseline="middle" y="245" x="399">
      <tspan x="399">Active Session with Negotiated Features</tspan>
    </text>
  </g>
  
  <!-- Loops -->
  <g>
    <line class="loopLine" y2="275" x2="738" y1="275" x1="64"></line>
    <line class="loopLine" y2="520" x2="738" y1="275" x1="738"></line>
    <line class="loopLine" y2="520" x2="738" y1="520" x1="64"></line>
    <line class="loopLine" y2="520" x2="64" y1="275" x1="64"></line>
    <polygon class="labelBox" points="64,275 114,275 114,288 105.6,295 64,295"></polygon>
    <text class="labelText" y="288" x="89">loop</text>
    <text class="loopText" y="293" x="426">
      <tspan x="426">[Client Requests]</tspan>
    </text>
  </g>
  
  <g>
    <line class="loopLine" y2="530" x2="738" y1="530" x1="64"></line>
    <line class="loopLine" y2="775" x2="738" y1="530" x1="738"></line>
    <line class="loopLine" y2="775" x2="738" y1="775" x1="64"></line>
    <line class="loopLine" y2="775" x2="64" y1="530" x1="64"></line>
    <polygon class="labelBox" points="64,530 114,530 114,543 105.6,550 64,550"></polygon>
    <text class="labelText" y="543" x="89">loop</text>
    <text class="loopText" y="548" x="426">
      <tspan x="426">[Server Requests]</tspan>
    </text>
  </g>
  
  <g>
    <line class="loopLine" y2="785" x2="738" y1="785" x1="363"></line>
    <line class="loopLine" y2="930" x2="738" y1="785" x1="738"></line>
    <line class="loopLine" y2="930" x2="738" y1="930" x1="363"></line>
    <line class="loopLine" y2="930" x2="363" y1="785" x1="363"></line>
    <polygon class="labelBox" points="363,785 413,785 413,798 404.6,805 363,805"></polygon>
    <text class="labelText" y="798" x="388">loop</text>
    <text class="loopText" y="803" x="575.5">
      <tspan x="575.5">[Notifications]</tspan>
    </text>
  </g>
  
  <!-- Messages -->
  <text class="messageText" y="95" x="223">Initialize client</text>
  <line class="messageLine0" marker-end="url(#arrowhead)" y2="115" x2="370" y1="115" x1="76"></line>
  
  <text class="messageText" y="145" x="549">Initialize session with capabilities</text>
  <line class="messageLine0" marker-end="url(#arrowhead)" y2="165" x2="715" y1="165" x1="383"></line>
  
  <text class="messageText" y="195" x="552">Respond with supported capabilities</text>
  <line class="messageLine1" marker-end="url(#arrowhead)" y2="215" x2="386" y1="215" x1="718"></line>
  
  <text class="messageText" y="340" x="223">User- or model-initiated action</text>
  <line class="messageLine0" marker-end="url(#arrowhead)" y2="360" x2="370" y1="360" x1="76"></line>
  
  <text class="messageText" y="390" x="549">Request (tools/resources)</text>
  <line class="messageLine0" marker-end="url(#arrowhead)" y2="410" x2="715" y1="410" x1="383"></line>
  
  <text class="messageText" y="440" x="552">Response</text>
  <line class="messageLine1" marker-end="url(#arrowhead)" y2="460" x2="386" y1="460" x1="718"></line>
  
  <text class="messageText" y="490" x="226">Update UI or respond to model</text>
  <line class="messageLine1" marker-end="url(#arrowhead)" y2="510" x2="79" y1="510" x1="373"></line>
  
  <text class="messageText" y="595" x="552">Request (sampling)</text>
  <line class="messageLine0" marker-end="url(#arrowhead)" y2="615" x2="386" y1="615" x1="718"></line>
  
  <text class="messageText" y="645" x="226">Forward to AI</text>
  <line class="messageLine0" marker-end="url(#arrowhead)" y2="665" x2="79" y1="665" x1="373"></line>
  
  <text class="messageText" y="695" x="223">AI response</text>
  <line class="messageLine1" marker-end="url(#arrowhead)" y2="715" x2="370" y1="715" x1="76"></line>
  
  <text class="messageText" y="745" x="549">Response</text>
  <line class="messageLine1" marker-end="url(#arrowhead)" y2="765" x2="715" y1="765" x1="383"></line>
  
  <text class="messageText" y="850" x="552">Resource updates</text>
  <line class="messageLine1" marker-end="url(#filled-head)" y2="870" x2="386" y1="870" x1="718"></line>
  
  <text class="messageText" y="900" x="549">Status changes</text>
  <line class="messageLine1" marker-end="url(#filled-head)" y2="920" x2="715" y1="920" x1="383"></line>
  
  <text class="messageText" y="960" x="223">Terminate</text>
  <line class="messageLine0" marker-end="url(#arrowhead)" y2="980" x2="370" y1="980" x1="76"></line>
  
  <text class="messageText" y="1010" x="549">End session</text>
  <line class="messageLine0" marker-end="url(#arrowhead)" y2="1030" x2="715" y1="1030" x1="383"></line>
</svg>